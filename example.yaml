forward:
  scheme: http
  host: proxy.example.com

limits:
  bearer/events:
    interval: 15
    max: 200
    keys:
      - 'headers:authentication'
    matches:
      headers:
        - name: "Authentication"
          match: "Bearer"
        - name: "X-Forwarded-For"
          match: "192.0.0.1"
      paths:
        match_any:
          - "/v1.1/push/events/.*"
          - "/v2.1/.*/events$"

  basic/events:
    interval: 15
    max: 200
    keys:
      - 'header:authentication'
    matches:
      paths:
        match_any:
          - "/v1.1/push/events/.*"
      headers:
        - name: "Authentication"
          match: "Basic"

  bearer/main:
    interval: 15
    max: 200
    keys:
      - 'header:authentication'
    matches:
      headers:
        - name: "Authentication"
          match: bearer
    excludes:
      paths:
        match_any:
          - "/v1.1/push/events/.*"

  basic/main:
    interval: 15
    max: 200
    keys:
      - 'header:authentication'
    matches:
      headers:
        - name: "Authentication"
          match: "Basic"
    excludes:
      paths:
        match_any:
          - "/v1.1/push/events/.*"
